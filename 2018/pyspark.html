<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="pyspark," />





  <link rel="alternate" href="/atom.xml" title="Hoooge's Blog" type="application/atom+xml" />






<meta name="description" content="RDDçš„å†…éƒ¨è¿è¡Œæ–¹å¼RDDä¸ä»…æ˜¯ä¸€ç»„ä¸å¯å˜çš„JVMï¼ˆJavaè™šæ‹Ÿæœºï¼‰å¯¹è±¡çš„åˆ†å¸ƒé›†ï¼Œè€Œä¸”æ˜¯Sparkçš„æ ¸å¿ƒï¼Œå¯ä»¥è®©ä»»åŠ¡æ‰§è¡Œé«˜é€Ÿè¿ç®—ã€‚ RDDå°†è·Ÿè¸ªï¼ˆè®¡å…¥æ—¥è®°ï¼‰åº”ç”¨äºæ¯ä¸ªå¿«çš„æ‰€æœ‰è½¬æ¢ï¼Œä»¥åŠ é€Ÿè®¡ç®—é€Ÿåº¦ï¼Œå¹¶åœ¨å‘ç”Ÿé”™è¯¯å’Œéƒ¨åˆ†æ•°æ®ä¸¢å¤±æ—¶æä¾›å›é€€ï¼ˆå®¹é”™æœºåˆ¶ï¼‰ã€‚ RDDé‡‡ç”¨å¹¶è¡Œçš„è¿è¡Œæ–¹å¼ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªè½¬æ¢æ“ä½œå¹¶è¡Œæ‰§è¡Œï¼Œä»è€Œæé«˜é€Ÿåº¦ã€‚RDDæœ‰ä¸¤ç§å¹¶è¡Œæ“ä½œï¼š  è½¬æ¢æ“ä½œï¼ˆè¿”å›æŒ‡å‘æ–°çš„RDDçš„æŒ‡é’ˆï¼‰ åŠ¨ä½œæ“ä½œï¼ˆåœ¨è¿è¡Œè®¡ç®—">
<meta name="keywords" content="pyspark">
<meta property="og:type" content="article">
<meta property="og:title" content="å¼¹æ€§å¼åˆ†å¸ƒæ•°æ®é›†RDDâ€”â€”PysparkåŸºç¡€ ï¼ˆäºŒï¼‰">
<meta property="og:url" content="http://www.ihoge.cn/2018/pyspark.html">
<meta property="og:site_name" content="Hoooge&#39;s Blog">
<meta property="og:description" content="RDDçš„å†…éƒ¨è¿è¡Œæ–¹å¼RDDä¸ä»…æ˜¯ä¸€ç»„ä¸å¯å˜çš„JVMï¼ˆJavaè™šæ‹Ÿæœºï¼‰å¯¹è±¡çš„åˆ†å¸ƒé›†ï¼Œè€Œä¸”æ˜¯Sparkçš„æ ¸å¿ƒï¼Œå¯ä»¥è®©ä»»åŠ¡æ‰§è¡Œé«˜é€Ÿè¿ç®—ã€‚ RDDå°†è·Ÿè¸ªï¼ˆè®¡å…¥æ—¥è®°ï¼‰åº”ç”¨äºæ¯ä¸ªå¿«çš„æ‰€æœ‰è½¬æ¢ï¼Œä»¥åŠ é€Ÿè®¡ç®—é€Ÿåº¦ï¼Œå¹¶åœ¨å‘ç”Ÿé”™è¯¯å’Œéƒ¨åˆ†æ•°æ®ä¸¢å¤±æ—¶æä¾›å›é€€ï¼ˆå®¹é”™æœºåˆ¶ï¼‰ã€‚ RDDé‡‡ç”¨å¹¶è¡Œçš„è¿è¡Œæ–¹å¼ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªè½¬æ¢æ“ä½œå¹¶è¡Œæ‰§è¡Œï¼Œä»è€Œæé«˜é€Ÿåº¦ã€‚RDDæœ‰ä¸¤ç§å¹¶è¡Œæ“ä½œï¼š  è½¬æ¢æ“ä½œï¼ˆè¿”å›æŒ‡å‘æ–°çš„RDDçš„æŒ‡é’ˆï¼‰ åŠ¨ä½œæ“ä½œï¼ˆåœ¨è¿è¡Œè®¡ç®—">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/006tNc79ly1fqdbpax6jbj31kw0hntga.jpg">
<meta property="og:updated_time" content="2018-04-22T14:55:20.485Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="å¼¹æ€§å¼åˆ†å¸ƒæ•°æ®é›†RDDâ€”â€”PysparkåŸºç¡€ ï¼ˆäºŒï¼‰">
<meta name="twitter:description" content="RDDçš„å†…éƒ¨è¿è¡Œæ–¹å¼RDDä¸ä»…æ˜¯ä¸€ç»„ä¸å¯å˜çš„JVMï¼ˆJavaè™šæ‹Ÿæœºï¼‰å¯¹è±¡çš„åˆ†å¸ƒé›†ï¼Œè€Œä¸”æ˜¯Sparkçš„æ ¸å¿ƒï¼Œå¯ä»¥è®©ä»»åŠ¡æ‰§è¡Œé«˜é€Ÿè¿ç®—ã€‚ RDDå°†è·Ÿè¸ªï¼ˆè®¡å…¥æ—¥è®°ï¼‰åº”ç”¨äºæ¯ä¸ªå¿«çš„æ‰€æœ‰è½¬æ¢ï¼Œä»¥åŠ é€Ÿè®¡ç®—é€Ÿåº¦ï¼Œå¹¶åœ¨å‘ç”Ÿé”™è¯¯å’Œéƒ¨åˆ†æ•°æ®ä¸¢å¤±æ—¶æä¾›å›é€€ï¼ˆå®¹é”™æœºåˆ¶ï¼‰ã€‚ RDDé‡‡ç”¨å¹¶è¡Œçš„è¿è¡Œæ–¹å¼ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªè½¬æ¢æ“ä½œå¹¶è¡Œæ‰§è¡Œï¼Œä»è€Œæé«˜é€Ÿåº¦ã€‚RDDæœ‰ä¸¤ç§å¹¶è¡Œæ“ä½œï¼š  è½¬æ¢æ“ä½œï¼ˆè¿”å›æŒ‡å‘æ–°çš„RDDçš„æŒ‡é’ˆï¼‰ åŠ¨ä½œæ“ä½œï¼ˆåœ¨è¿è¡Œè®¡ç®—">
<meta name="twitter:image" content="https://ws1.sinaimg.cn/large/006tNc79ly1fqdbpax6jbj31kw0hntga.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.ihoge.cn/2018/pyspark.html"/>





  <title>å¼¹æ€§å¼åˆ†å¸ƒæ•°æ®é›†RDDâ€”â€”PysparkåŸºç¡€ ï¼ˆäºŒï¼‰ | Hoooge's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <a href="https://github.com/hooog" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hoooge's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Life is short</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            Ãœber
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Kategorien
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.ihoge.cn/2018/pyspark.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="åˆ˜çŸ¥è¡Œ">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hoooge's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">å¼¹æ€§å¼åˆ†å¸ƒæ•°æ®é›†RDDâ€”â€”PysparkåŸºç¡€ ï¼ˆäºŒï¼‰</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">VerÃ¶ffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-15T17:59:21+08:00">
                2018-04-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spark/" itemprop="url" rel="index">
                    <span itemprop="name">Spark</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i> æµè§ˆ
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>K
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="RDDçš„å†…éƒ¨è¿è¡Œæ–¹å¼"><a href="#RDDçš„å†…éƒ¨è¿è¡Œæ–¹å¼" class="headerlink" title="RDDçš„å†…éƒ¨è¿è¡Œæ–¹å¼"></a>RDDçš„å†…éƒ¨è¿è¡Œæ–¹å¼</h2><p>RDDä¸ä»…æ˜¯ä¸€ç»„ä¸å¯å˜çš„JVMï¼ˆJavaè™šæ‹Ÿæœºï¼‰å¯¹è±¡çš„åˆ†å¸ƒé›†ï¼Œè€Œä¸”æ˜¯Sparkçš„æ ¸å¿ƒï¼Œå¯ä»¥è®©ä»»åŠ¡æ‰§è¡Œé«˜é€Ÿè¿ç®—ã€‚</p>
<p>RDDå°†<code>è·Ÿè¸ªï¼ˆè®¡å…¥æ—¥è®°ï¼‰åº”ç”¨äºæ¯ä¸ªå¿«çš„æ‰€æœ‰è½¬æ¢</code>ï¼Œä»¥åŠ é€Ÿè®¡ç®—é€Ÿåº¦ï¼Œå¹¶åœ¨å‘ç”Ÿé”™è¯¯å’Œéƒ¨åˆ†æ•°æ®ä¸¢å¤±æ—¶æä¾›å›é€€ï¼ˆå®¹é”™æœºåˆ¶ï¼‰ã€‚</p>
<p>RDDé‡‡ç”¨å¹¶è¡Œçš„è¿è¡Œæ–¹å¼ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªè½¬æ¢æ“ä½œå¹¶è¡Œæ‰§è¡Œï¼Œä»è€Œæé«˜é€Ÿåº¦ã€‚<br>RDDæœ‰ä¸¤ç§å¹¶è¡Œæ“ä½œï¼š</p>
<ul>
<li>è½¬æ¢æ“ä½œï¼ˆè¿”å›æŒ‡å‘æ–°çš„RDDçš„æŒ‡é’ˆï¼‰</li>
<li>åŠ¨ä½œæ“ä½œï¼ˆåœ¨è¿è¡Œè®¡ç®—åå‘é©±åŠ¨ç¨‹åºè¿”å›å€¼ï¼‰</li>
</ul>
<p>æ•°æ®é›†çš„è½¬æ¢é€šå¸¸æ˜¯<code>æƒ°æ€§</code>çš„ï¼Œè¿™ä¹Ÿæ„å‘³ç€ä»»ä½•è½¬æ¢æ“ä½œä»…åœ¨è°ƒç”¨æ•°æ®é›†ä¸Šçš„æ“ä½œæ—¶æ‰æ‰§è¡Œã€‚è¯¥å»¶è¿Ÿæ‰§è¡Œä¼šäº§ç”Ÿé£å¤šçš„ç²¾ç»†æŸ¥è¯¢ï¼šé’ˆå¯¹æ€§èƒ½è¿›è¡Œä¼˜åŒ–æŸ¥è¯¢ã€‚è¿™ç§ä¼˜åŒ–å§‹äºSparkçš„DAGSchedulerâ€”â€”é¢å‘é˜¶æ®µçš„è°ƒåº¦å™¨ã€‚DAGSchedulerè´Ÿè´£Stageçº§çš„è°ƒåº¦è¯¦è§:<a href="http://ihoge.cn/2018/Spark%20Scheduler.html" target="_blank" rel="noopener">Sparkè¿è¡ŒåŸç†å‰–æ</a></p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1fqdbpax6jbj31kw0hntga.jpg" alt=""></p>
<p><strong>ç”±äºå…·æœ‰å•ç‹¬çš„RDDè½¬æ¢å’ŒåŠ¨ä½œï¼ŒDAGSchedulerå¯ä»¥åœ¨æŸ¥è¯¢ä¸­æ‰§è¡Œä¼˜åŒ–ã€‚åŒ…æ‹¬ä½†ä¸é™äºé¿å…shuffleæ•°æ®ï¼ˆæœ€è€—è´¹èµ„æºçš„ä»»åŠ¡ï¼‰</strong></p>
<h2 id="åˆ›å»ºRDD"><a href="#åˆ›å»ºRDD" class="headerlink" title="åˆ›å»ºRDD"></a>åˆ›å»ºRDD</h2><p>æ–¹å¼ä¸€ï¼š ç”¨<code>.parallelize(...)</code>é›†åˆï¼ˆå…ƒç´ listæˆ–arrayï¼‰<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data = sc.parallelize([(<span class="string">'a'</span>,<span class="number">1</span>),(<span class="string">'b'</span>,<span class="number">2</span>),(<span class="string">'c'</span>,<span class="number">3</span>),(<span class="string">'d'</span>,<span class="number">5</span>),(<span class="string">'e'</span>,<span class="number">5</span>)])</span><br></pre></td></tr></table></figure></p>
<p>æ–¹å¼äºŒï¼š è¯»å…¥å¤–éƒ¨æ–‡ä»¶</p>
<ul>
<li>æ”¯æŒå¤šæ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–ï¼šå¦‚NTFSã€FATã€HFS+ï¼ˆMac OS Extendedï¼‰ï¼Œæˆ–è€…å¦‚HDFSã€S3ã€Cassandraè¿™ç±»çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œè¿˜æœ‰å…¶ä»–ç±»æ–‡ä»¶ç³»ç»Ÿã€‚</li>
<li>æŒ‡å‡ºå¤šç§æ•°æ®æ ¼å¼ï¼šå¦‚æ–‡æœ¬ã€parquetã€JSONã€Hive tablesï¼ˆHiveè¡¨ï¼‰ä»¥åŠä½¿ç”¨JDBCé©±åŠ¨ç¨‹åºå¯è¯»å–çš„å…³ç³»æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚ï¼ˆæ³¨æ„ï¼šSparkå¯ä»¥è‡ªåŠ¨å¤„ç†å‹ç¼©æ•°æ®é›†ï¼‰</li>
</ul>
<p>ğŸ’¡<strong>Tip1ï¼š</strong>è¯»å–çš„æ–¹å¼ä¸åŒï¼ŒæŒæœ‰å¯¹è±¡è¡¨è¾¾æ–¹å¼ä¹Ÿä¸åŒã€‚ä»æ–‡ä»¶ä¸­è¯»å–çš„æ•°æ®è¡¨ç¤ºä¸º<code>MapPartitionsRDD</code>ï¼›ä½¿ç”¨é›†åˆæ–¹æ³•çš„æ•°æ®è¡¨ç¤ºä¸º<code>ParallelCollectionRDD</code></p>
<p>ğŸ’¡<strong>Tip2ï¼š</strong>RDDæ˜¯æ— schemaçš„æ•°æ®ç»“æ„ï¼ˆå’ŒDataFrameä¸åŒï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å‡ ä¹å¯ä»¥æ··ç”¨ä»»ä½•æ•°æ®ç»“æ„ï¼štupleã€dictã€listå’Œsparkç­‰éƒ½èƒ½æ”¯æŒã€‚å¦‚æœå¯¹æ•°æ®é›†ä½¿ç”¨<code>.collect()</code>æ–¹æ³•ï¼Œå°†æŠŠRDDå¯¹æ‰€æœ‰å…ƒç´ è¿”å›ç»™é©±åŠ¨ç¨‹åºï¼Œé©±åŠ¨ç¨‹åºå°†å…¶åºåˆ—åŒ–æˆäº†ä¸€ä¸ªåˆ—è¡¨ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_from_file = sc.textFile(<span class="string">"hdfs://master:9000/pydata/VS14MORT.txt.gz"</span>,<span class="number">4</span>) <span class="comment"># è¿™é‡Œè¡¨ç¤º4ä¸ªåˆ†åŒº</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">extractInformation</span><span class="params">(row)</span>:</span></span><br><span class="line">    <span class="keyword">import</span> re</span><br><span class="line">    <span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">    selected_indices = [</span><br><span class="line">         <span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,</span><br><span class="line">         <span class="number">19</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">32</span>,<span class="number">33</span>,<span class="number">34</span>,</span><br><span class="line">         <span class="number">36</span>,<span class="number">37</span>,<span class="number">38</span>,<span class="number">39</span>,<span class="number">40</span>,<span class="number">41</span>,<span class="number">42</span>,<span class="number">43</span>,<span class="number">44</span>,<span class="number">45</span>,<span class="number">46</span>,<span class="number">47</span>,<span class="number">48</span>,</span><br><span class="line">         <span class="number">49</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">52</span>,<span class="number">53</span>,<span class="number">54</span>,<span class="number">55</span>,<span class="number">56</span>,<span class="number">58</span>,<span class="number">60</span>,<span class="number">61</span>,<span class="number">62</span>,<span class="number">63</span>,</span><br><span class="line">         <span class="number">64</span>,<span class="number">65</span>,<span class="number">66</span>,<span class="number">67</span>,<span class="number">68</span>,<span class="number">69</span>,<span class="number">70</span>,<span class="number">71</span>,<span class="number">72</span>,<span class="number">73</span>,<span class="number">74</span>,<span class="number">75</span>,<span class="number">76</span>,</span><br><span class="line">         <span class="number">77</span>,<span class="number">78</span>,<span class="number">79</span>,<span class="number">81</span>,<span class="number">82</span>,<span class="number">83</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">87</span>,<span class="number">89</span></span><br><span class="line">    ]</span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        Input record schema</span></span><br><span class="line"><span class="string">        schema: n-m (o) -- xxx</span></span><br><span class="line"><span class="string">            n - position from</span></span><br><span class="line"><span class="string">            m - position to</span></span><br><span class="line"><span class="string">            o - number of characters</span></span><br><span class="line"><span class="string">            xxx - description</span></span><br><span class="line"><span class="string">        1. 1-19 (19) -- reserved positions</span></span><br><span class="line"><span class="string">        2. 20 (1) -- resident status</span></span><br><span class="line"><span class="string">        3. 21-60 (40) -- reserved positions</span></span><br><span class="line"><span class="string">        4. 61-62 (2) -- education code (1989 revision)</span></span><br><span class="line"><span class="string">        5. 63 (1) -- education code (2003 revision)</span></span><br><span class="line"><span class="string">        6. 64 (1) -- education reporting flag</span></span><br><span class="line"><span class="string">        7. 65-66 (2) -- month of death</span></span><br><span class="line"><span class="string">        8. 67-68 (2) -- reserved positions</span></span><br><span class="line"><span class="string">        9. 69 (1) -- sex</span></span><br><span class="line"><span class="string">        10. 70 (1) -- age: 1-years, 2-months, 4-days, 5-hours, 6-minutes, 9-not stated</span></span><br><span class="line"><span class="string">        11. 71-73 (3) -- number of units (years, months etc)</span></span><br><span class="line"><span class="string">        12. 74 (1) -- age substitution flag (if the age reported in positions 70-74 is calculated using dates of birth and death)</span></span><br><span class="line"><span class="string">        13. 75-76 (2) -- age recoded into 52 categories</span></span><br><span class="line"><span class="string">        14. 77-78 (2) -- age recoded into 27 categories</span></span><br><span class="line"><span class="string">        15. 79-80 (2) -- age recoded into 12 categories</span></span><br><span class="line"><span class="string">        16. 81-82 (2) -- infant age recoded into 22 categories</span></span><br><span class="line"><span class="string">        17. 83 (1) -- place of death</span></span><br><span class="line"><span class="string">        18. 84 (1) -- marital status</span></span><br><span class="line"><span class="string">        19. 85 (1) -- day of the week of death</span></span><br><span class="line"><span class="string">        20. 86-101 (16) -- reserved positions</span></span><br><span class="line"><span class="string">        21. 102-105 (4) -- current year</span></span><br><span class="line"><span class="string">        22. 106 (1) -- injury at work</span></span><br><span class="line"><span class="string">        23. 107 (1) -- manner of death</span></span><br><span class="line"><span class="string">        24. 108 (1) -- manner of disposition</span></span><br><span class="line"><span class="string">        25. 109 (1) -- autopsy</span></span><br><span class="line"><span class="string">        26. 110-143 (34) -- reserved positions</span></span><br><span class="line"><span class="string">        27. 144 (1) -- activity code</span></span><br><span class="line"><span class="string">        28. 145 (1) -- place of injury</span></span><br><span class="line"><span class="string">        29. 146-149 (4) -- ICD code</span></span><br><span class="line"><span class="string">        30. 150-152 (3) -- 358 cause recode</span></span><br><span class="line"><span class="string">        31. 153 (1) -- reserved position</span></span><br><span class="line"><span class="string">        32. 154-156 (3) -- 113 cause recode</span></span><br><span class="line"><span class="string">        33. 157-159 (3) -- 130 infant cause recode</span></span><br><span class="line"><span class="string">        34. 160-161 (2) -- 39 cause recode</span></span><br><span class="line"><span class="string">        35. 162 (1) -- reserved position</span></span><br><span class="line"><span class="string">        36. 163-164 (2) -- number of entity-axis conditions</span></span><br><span class="line"><span class="string">        37-56. 165-304 (140) -- list of up to 20 conditions</span></span><br><span class="line"><span class="string">        57. 305-340 (36) -- reserved positions</span></span><br><span class="line"><span class="string">        58. 341-342 (2) -- number of record axis conditions</span></span><br><span class="line"><span class="string">        59. 343 (1) -- reserved position</span></span><br><span class="line"><span class="string">        60-79. 344-443 (100) -- record axis conditions</span></span><br><span class="line"><span class="string">        80. 444 (1) -- reserve position</span></span><br><span class="line"><span class="string">        81. 445-446 (2) -- race</span></span><br><span class="line"><span class="string">        82. 447 (1) -- bridged race flag</span></span><br><span class="line"><span class="string">        83. 448 (1) -- race imputation flag</span></span><br><span class="line"><span class="string">        84. 449 (1) -- race recode (3 categories)</span></span><br><span class="line"><span class="string">        85. 450 (1) -- race recode (5 categories)</span></span><br><span class="line"><span class="string">        86. 461-483 (33) -- reserved positions</span></span><br><span class="line"><span class="string">        87. 484-486 (3) -- Hispanic origin</span></span><br><span class="line"><span class="string">        88. 487 (1) -- reserved</span></span><br><span class="line"><span class="string">        89. 488 (1) -- Hispanic origin/race recode</span></span><br><span class="line"><span class="string">     '''</span></span><br><span class="line">    record_split = re\</span><br><span class="line">        .compile(</span><br><span class="line">            <span class="string">r'([\s]&#123;19&#125;)([0-9]&#123;1&#125;)([\s]&#123;40&#125;)([0-9\s]&#123;2&#125;)([0-9\s]&#123;1&#125;)([0-9]&#123;1&#125;)([0-9]&#123;2&#125;)'</span> + </span><br><span class="line">            <span class="string">r'([\s]&#123;2&#125;)([FM]&#123;1&#125;)([0-9]&#123;1&#125;)([0-9]&#123;3&#125;)([0-9\s]&#123;1&#125;)([0-9]&#123;2&#125;)([0-9]&#123;2&#125;)'</span> + </span><br><span class="line">            <span class="string">r'([0-9]&#123;2&#125;)([0-9\s]&#123;2&#125;)([0-9]&#123;1&#125;)([SMWDU]&#123;1&#125;)([0-9]&#123;1&#125;)([\s]&#123;16&#125;)([0-9]&#123;4&#125;)'</span> +</span><br><span class="line">            <span class="string">r'([YNU]&#123;1&#125;)([0-9\s]&#123;1&#125;)([BCOU]&#123;1&#125;)([YNU]&#123;1&#125;)([\s]&#123;34&#125;)([0-9\s]&#123;1&#125;)([0-9\s]&#123;1&#125;)'</span> +</span><br><span class="line">            <span class="string">r'([A-Z0-9\s]&#123;4&#125;)([0-9]&#123;3&#125;)([\s]&#123;1&#125;)([0-9\s]&#123;3&#125;)([0-9\s]&#123;3&#125;)([0-9\s]&#123;2&#125;)([\s]&#123;1&#125;)'</span> + </span><br><span class="line">            <span class="string">r'([0-9\s]&#123;2&#125;)([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)'</span> + </span><br><span class="line">            <span class="string">r'([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)'</span> + </span><br><span class="line">            <span class="string">r'([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)'</span> + </span><br><span class="line">            <span class="string">r'([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)([A-Z0-9\s]&#123;7&#125;)'</span> + </span><br><span class="line">            <span class="string">r'([A-Z0-9\s]&#123;7&#125;)([\s]&#123;36&#125;)([A-Z0-9\s]&#123;2&#125;)([\s]&#123;1&#125;)([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)'</span> + </span><br><span class="line">            <span class="string">r'([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)'</span> + </span><br><span class="line">            <span class="string">r'([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)'</span> + </span><br><span class="line">            <span class="string">r'([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)'</span> + </span><br><span class="line">            <span class="string">r'([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)([A-Z0-9\s]&#123;5&#125;)([\s]&#123;1&#125;)([0-9\s]&#123;2&#125;)([0-9\s]&#123;1&#125;)'</span> + </span><br><span class="line">            <span class="string">r'([0-9\s]&#123;1&#125;)([0-9\s]&#123;1&#125;)([0-9\s]&#123;1&#125;)([\s]&#123;33&#125;)([0-9\s]&#123;3&#125;)([0-9\s]&#123;1&#125;)([0-9\s]&#123;1&#125;)'</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        rs = np.array(record_split.split(row))[selected_indices]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        rs = np.array([<span class="string">'-99'</span>] * len(selected_indices))</span><br><span class="line">    <span class="keyword">return</span> rs</span><br><span class="line"></span><br><span class="line">data_file = data_from_file.map(extractInformation)</span><br><span class="line">data_file.map(<span class="keyword">lambda</span> row: row).take(<span class="number">1</span>)</span><br><span class="line">data_file.cache()</span><br><span class="line">data_file.is_cached</span><br></pre></td></tr></table></figure>
<pre><code>True
</code></pre><h2 id="å…¨å±€ä½œç”¨åŸŸå’Œå±€éƒ¨ä½œç”¨åŸŸ"><a href="#å…¨å±€ä½œç”¨åŸŸå’Œå±€éƒ¨ä½œç”¨åŸŸ" class="headerlink" title="å…¨å±€ä½œç”¨åŸŸå’Œå±€éƒ¨ä½œç”¨åŸŸ"></a>å…¨å±€ä½œç”¨åŸŸå’Œå±€éƒ¨ä½œç”¨åŸŸ</h2><p>Sparkå¯ä»¥åœ¨ä¸¤ç§æ¨¡å¼ä¸‹è¿è¡Œï¼šæœ¬åœ°å’Œé›†ç¾¤ã€‚æœ¬åœ°è¿è¡ŒSparkä»£ç æ—¶å’Œç›®å‰ä½¿ç”¨çš„pythonæ²¡æœ‰è¯´æ˜ä¸åŒã€‚ç„¶è€Œä»–å¦‚æœå°†ç›¸åŒçš„ä»£ç éƒ¨ç½²åˆ°é›†ç¾¤ï¼Œä¾¿å¯èƒ½ä¼šå¯¼è‡´å¤§é‡çš„å›°æ‰°ï¼Œè¿™å°±éœ€è¦äº†è§£Sparkæ˜¯æ€ä¹ˆåœ¨é›†ç¾¤ä¸Šæ‰§è¡Œå·¥ä½œçš„ã€‚è¿™é‡Œæœ‰ä¸€ç¯‡æ–‡ç« ä»‹ç»çš„å¾ˆè¯¦ç»†ã€‚<a href="http://ihoge.cn/2018/Spark%20Scheduler.html" target="_blank" rel="noopener">å‚è€ƒï¼šSparkè¿è¡ŒåŸç†è¯¦è§£</a></p>
<p>åœ¨é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œæäº¤ä»»åŠ¡æ—¶ä»»åŠ¡å‘é€ç»™äº†MasterèŠ‚ç‚¹ã€‚è¯¥é©±åŠ¨ç¨‹åºèŠ‚ç‚¹ä¸ºä»»åŠ¡åˆ›å»ºDAGï¼Œå¹¶ä¸”å†³å®šå“ªä¸€ä¸ªæ‰§è¡Œè€…ï¼ˆWorkerï¼‰èŠ‚ç‚¹è¿è¡Œç‰¹å®šçš„ä»»åŠ¡ã€‚ç„¶åè¯¥é©±åŠ¨ç¨‹åºçŸ¥è¯†å·¥ä½œè€…æ‰§è¡Œå®ƒä»¬çš„ä»»åŠ¡ï¼Œå¹¶ä¸”åœ¨ç»“æŸæ—¶å°†ç»“æœè¿”å›ç»™é©±åŠ¨ç¨‹åºã€‚ç„¶è€Œåœ¨è¿™ä¹‹å‰ï¼Œé©±åŠ¨ç¨‹åºä¸ºæ¯ä¸€ä¸ªä»»åŠ¡çš„ç»ˆæ­¢åšå‡†å¤‡ï¼šé©±åŠ¨ç¨‹åºä¸­æœ‰ä¸€ç»„å˜é‡å’Œæ–¹æ³•ï¼Œä»¥å˜å·¥ä½œè€…åœ¨RDDä¸Šæ‰§è¡Œä»»åŠ¡ã€‚</p>
<p>è¿™ç»„å˜é‡å’Œæ–¹æ³•åœ¨æ‰§è¡Œè€…çš„ä¸Šä¸‹é—®æœ¬è´¨ä¸Šæ˜¯é™æ€çš„ï¼Œæ¯ä¸ªæ‰§è¡Œå™¨ä»é©±åŠ¨ç¨‹åºä¸­è·å–çš„ä¸€ä»½å˜é‡å’Œæ–¹æ³•çš„<strong>å‰¯æœ¬</strong>ã€‚è¿™æ„å‘³ç€è¿è¡Œä»»åŠ¡æ—¶ï¼Œå¦‚æœæ‰§è¡Œè€…æ”¹å˜è¿™äº›å˜é‡æˆ–è¦†ç›–è¿™äº›æ–¹æ³•ï¼Œå®ƒä¸å½±å“ä»»ä½•å…¶ä»–æ‰§è¡Œè€…çš„å‰¯æœ¬æˆ–è€…é©±åŠ¨ç¨‹åºçš„å˜é‡å’Œæ–¹æ³•ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›æ„æƒ³ä¸åˆ°çš„è¡Œä¸ºå’Œè¿è¡Œé”™è¯¯ï¼Œè¿™äº›è¡Œä¸ºå’Œé”™è¯¯é€šå¸¸éƒ½å¾ˆéš¾è¢«è¿½è¸ªåˆ°ã€‚</p>
<h2 id="è½¬æ¢"><a href="#è½¬æ¢" class="headerlink" title="è½¬æ¢"></a>è½¬æ¢</h2><p>è½¬æ¢æ“ä½œå¯ä»¥è°ƒæ•´æ•°æ®é›†ã€‚åŒ…æ‹¬æ˜ å°„ã€ç­›é€‰ã€é“¾æ¥ã€è½¬æ¢æ•°æ®é›†ä¸­çš„å€¼ã€‚</p>
<h3 id="map-è½¬æ¢"><a href="#map-è½¬æ¢" class="headerlink" title=".map()è½¬æ¢"></a>.map()è½¬æ¢</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data_2014 = data_file.map(<span class="keyword">lambda</span> x: x[<span class="number">16</span>])</span><br><span class="line">data_2014.take(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<pre><code>[&apos;2014&apos;, &apos;2014&apos;, &apos;2014&apos;, &apos;2014&apos;, &apos;2014&apos;, &apos;2014&apos;, &apos;2014&apos;, &apos;2014&apos;, &apos;2014&apos;, &apos;-99&apos;]
</code></pre><h3 id="filter-è½¬æ¢"><a href="#filter-è½¬æ¢" class="headerlink" title=".filter()è½¬æ¢"></a>.filter()è½¬æ¢</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data_filter = data_file.filter(<span class="keyword">lambda</span> x: x[<span class="number">16</span>] == <span class="string">'2014'</span> <span class="keyword">and</span> x[<span class="number">21</span>] == <span class="string">'0'</span>)</span><br><span class="line">print(data_filter.count())</span><br><span class="line">data_file.take(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<pre><code>22





[array([&apos;1&apos;, &apos;  &apos;, &apos;2&apos;, &apos;1&apos;, &apos;01&apos;, &apos;M&apos;, &apos;1&apos;, &apos;087&apos;, &apos; &apos;, &apos;43&apos;, &apos;23&apos;, &apos;11&apos;,
        &apos;  &apos;, &apos;4&apos;, &apos;M&apos;, &apos;4&apos;, &apos;2014&apos;, &apos;U&apos;, &apos;7&apos;, &apos;C&apos;, &apos;N&apos;, &apos; &apos;, &apos; &apos;, &apos;I64 &apos;,
        &apos;238&apos;, &apos;070&apos;, &apos;   &apos;, &apos;24&apos;, &apos;01&apos;, &apos;11I64  &apos;, &apos;       &apos;, &apos;       &apos;,
        &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;,
        &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;,
        &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;01&apos;,
        &apos;I64  &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;,
        &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;,
        &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;01&apos;, &apos; &apos;,
        &apos; &apos;, &apos;1&apos;, &apos;1&apos;, &apos;100&apos;, &apos;6&apos;], dtype=&apos;&lt;U40&apos;),
 array([&apos;1&apos;, &apos;  &apos;, &apos;2&apos;, &apos;1&apos;, &apos;01&apos;, &apos;M&apos;, &apos;1&apos;, &apos;058&apos;, &apos; &apos;, &apos;37&apos;, &apos;17&apos;, &apos;08&apos;,
        &apos;  &apos;, &apos;4&apos;, &apos;D&apos;, &apos;3&apos;, &apos;2014&apos;, &apos;U&apos;, &apos;7&apos;, &apos;C&apos;, &apos;N&apos;, &apos; &apos;, &apos; &apos;, &apos;I250&apos;,
        &apos;214&apos;, &apos;062&apos;, &apos;   &apos;, &apos;21&apos;, &apos;03&apos;, &apos;11I250 &apos;, &apos;61I272 &apos;, &apos;62E669 &apos;,
        &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;,
        &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;,
        &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;       &apos;, &apos;03&apos;,
        &apos;I250 &apos;, &apos;E669 &apos;, &apos;I272 &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;,
        &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;,
        &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;     &apos;, &apos;01&apos;, &apos; &apos;,
        &apos; &apos;, &apos;1&apos;, &apos;1&apos;, &apos;100&apos;, &apos;6&apos;], dtype=&apos;&lt;U40&apos;)]
</code></pre><h3 id="flatMap-è½¬æ¢"><a href="#flatMap-è½¬æ¢" class="headerlink" title=".flatMap()è½¬æ¢"></a>.flatMap()è½¬æ¢</h3><p><code>.flatMap()</code>æ–¹æ³•å’Œ.map()å·¥ä½œç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯flatMap()è¿”å›ä¸€ä¸ªæ‰å¹³çš„ç»“æœè€Œä¸æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data_flat = data_file.flatMap(<span class="keyword">lambda</span> x: (x[<span class="number">16</span>], int(x[<span class="number">16</span>])+<span class="number">1</span>))</span><br><span class="line">data_flat.take(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<pre><code>[&apos;2014&apos;, 2015, &apos;2014&apos;, 2015, &apos;2014&apos;, 2015, &apos;2014&apos;, 2015, &apos;2014&apos;, 2015]
</code></pre><p>.flatMap()å¯ä»¥ç”¨äºè¿‡æ»¤ä¸€äº›æ ¼å¼ä¸æ­£ç¡®çš„è®°å½•ã€‚åœ¨è¿™ä¸ªæœºåˆ¶ä¸‹ï¼Œ.flatMap()æ–¹æ³•å§æ¯ä¸€è¡Œçœ‹ä½œä¸€ä¸ªåˆ—è¡¨å¯¹å¾…ï¼Œç„¶åå°†æ‰€æœ‰è®°å½•ç®€å•çš„åŠ å…¥åˆ°ä¸€èµ·ï¼Œé€šè¿‡ä¼ é€’ä¸€ä¸ªç©ºåˆ—è¡¨å¯ä»¥ä¸¢å¼ƒæ ¼å¼ä¸æ­£ç¡®çš„è®°å½•ã€‚</p>
<h3 id="distinct-è½¬æ¢"><a href="#distinct-è½¬æ¢" class="headerlink" title=".distinct()è½¬æ¢"></a>.distinct()è½¬æ¢</h3><p>è¿™é‡Œç”¨è¯¥æ–¹æ³•æ£€æŸ¥æ€§åˆ«åˆ—è¡¨æ˜¯å¦åªåŒ…å«äº†ç”·æ€§å’Œå¥³æ€§éªŒè¯æˆ‘ä»¬æ˜¯å¦å‡†ç¡®è§£é‡Šäº†æ•°æ®é›†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">distinct_gender = data_file.map(<span class="keyword">lambda</span> x: x[<span class="number">5</span>]).distinct()</span><br><span class="line">distinct_gender.collect()</span><br></pre></td></tr></table></figure>
<pre><code>[&apos;M&apos;, &apos;F&apos;, &apos;-99&apos;]
</code></pre><h3 id="sample-è½¬æ¢"><a href="#sample-è½¬æ¢" class="headerlink" title=".sample() è½¬æ¢"></a>.sample() è½¬æ¢</h3><p>è¯¥æ–¹æ³•è¿”å›æ•°æ®é›†çš„éšæœºæ ·æœ¬ã€‚ç¬¬ä¸€ä¸ªå‚æ•°<code>withReplacement</code>æŒ‡å®šé‡‡æ ·æ˜¯å¦åº”è¯¥æ›¿æ¢ï¼Œç¬¬äºŒä¸ªå‚æ•°<code>fraction</code>å®šä¹‰è¿”å›æ•°æ®é‡çš„ç™¾åˆ†æ¯”ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¼ªéšæœºæ•°äº§ç”Ÿå™¨çš„ç§å­<code>seed</code>ã€‚</p>
<p>ä¸ºäº†èŠ‚çœè¿ç®—æ—¶é—´ï¼Œè¿™é‡Œé€‰å–æ„¿æ•°æ®åƒåˆ†ä¹‹ä¸€çš„éšæœºæ•°æ®ä½œä¸ºä¸‹é¢çš„ç»ƒä¹ æ•°æ®ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data_sample = data_file.sample(<span class="keyword">False</span>, <span class="number">0.001</span>, <span class="number">666</span>)</span><br><span class="line">data_sample.cache()</span><br></pre></td></tr></table></figure>
<pre><code>PythonRDD[25] at RDD at PythonRDD.scala:48
</code></pre><h3 id="leftOuterJoin-è½¬æ¢"><a href="#leftOuterJoin-è½¬æ¢" class="headerlink" title=".leftOuterJoin()è½¬æ¢"></a>.leftOuterJoin()è½¬æ¢</h3><ul>
<li>.leftOuterJoin()ï¼š æ ¹æ®ä¸¤ä¸ªæ•°æ®é›†ä¸­éƒ½æœ‰å¾—å€¼æ¥è¿æ¥ä¸¤ä¸ªRDDï¼Œå¹¶è¿”å›<code>å·¦ä¾§</code>çš„RDDè®°å½•ï¼Œè€Œå³è¾¹çš„è®°å½•å‰¯åŠ è½½ä¸¤ä¸ªRDDåŒ¹é…çš„åœ°æ–¹ã€‚</li>
<li>.join() ï¼šåªè¿”å›ä¸¤ä¸ªRDDä¹‹é—´çš„å…³è”æ•°å€¼</li>
<li>.intersection()ï¼šè¿”å›ä¸¤ä¸ªRDDä¸­ç›¸ç­‰çš„è®°å½•</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rdd1 = sc.parallelize([(<span class="string">'a'</span>,<span class="number">1</span>), (<span class="string">'b'</span>,<span class="number">4</span>), (<span class="string">'c'</span>,<span class="number">10</span>)])</span><br><span class="line">rdd2 = sc.parallelize([(<span class="string">'a'</span>,<span class="number">4</span>), (<span class="string">'a'</span>,<span class="number">1</span>), (<span class="string">'b'</span>,<span class="number">6</span>), (<span class="string">'d'</span>,<span class="number">15</span>)])</span><br><span class="line">print(<span class="string">"leftOuterJoin: "</span>,rdd1.leftOuterJoin(rdd2).collect())</span><br><span class="line">print(<span class="string">"Join: "</span>,rdd1.join(rdd2).collect())</span><br><span class="line">print(<span class="string">"intersection: "</span>, rdd1.intersection(rdd2).collect())</span><br></pre></td></tr></table></figure>
<pre><code>leftOuterJoin:  [(&apos;c&apos;, (10, None)), (&apos;b&apos;, (4, 6)), (&apos;a&apos;, (1, 1)), (&apos;a&apos;, (1, 4))]
Join:  [(&apos;b&apos;, (4, 6)), (&apos;a&apos;, (1, 1)), (&apos;a&apos;, (1, 4))]
intersection:  [(&apos;a&apos;, 1)]
</code></pre><h3 id="repartition-è½¬æ¢"><a href="#repartition-è½¬æ¢" class="headerlink" title=".repartition()è½¬æ¢"></a>.repartition()è½¬æ¢</h3><p>é‡æ–°å¯¹æ•°æ®é›†è¿›è¡Œåˆ†åŒºï¼Œæ”¹å˜æ•°æ®é›†åˆ†èµ›åŒºçš„æ•°é‡ã€‚æ­¤åŠŸèƒ½åº”è¯¥è°¨æ…å¹¶ä¸”ä»…å½“çœŸæ­£éœ€è¦çš„æ—¶å€™ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä¼šå……è¶³æ•°æ®ï¼Œå¯¼è‡´æ€§èƒ½äº§ç”Ÿå·¨å¤§çš„å½±å“ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(len(rdd2.glom().collect()))</span><br><span class="line">rdd2 = rdd2.repartition(<span class="number">4</span>)</span><br><span class="line">print(len(rdd2.glom().collect()))</span><br></pre></td></tr></table></figure>
<pre><code>3
4
</code></pre><h2 id="åŠ¨ä½œ"><a href="#åŠ¨ä½œ" class="headerlink" title="åŠ¨ä½œ"></a>åŠ¨ä½œ</h2><h3 id="collect-åŠ¨ä½œ"><a href="#collect-åŠ¨ä½œ" class="headerlink" title=".collect() åŠ¨ä½œ"></a>.collect() åŠ¨ä½œ</h3><p>è¿”å›æ‰€æœ‰RDDçš„å…ƒç´ ç»™é©±åŠ¨ç¨‹åº</p>
<p>ğŸ’¡åŒæ—¶å¸¸ç”¨çš„è¿˜æœ‰: <code>.collectAsMap()</code>æ–¹æ³•</p>
<h3 id="take-åŠ¨ä½œ"><a href="#take-åŠ¨ä½œ" class="headerlink" title=".take() åŠ¨ä½œ"></a>.take() åŠ¨ä½œ</h3><p>å¯ä»¥è¯´è¿™äº‹æœ€æœ‰ç”¨çš„æ–¹æ³•ï¼Œè¿”å›<strong>å•ä¸ªæ•°æ®åˆ†åŒº</strong>çš„å‰nè¡Œã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rdd.take(<span class="number">1</span>)</span><br><span class="line"><span class="comment">#ç­‰åŒäº:</span></span><br><span class="line">rdd.first()</span><br></pre></td></tr></table></figure></p>
<h3 id="reduce-åŠ¨ä½œ"><a href="#reduce-åŠ¨ä½œ" class="headerlink" title=".reduce() åŠ¨ä½œ"></a>.reduce() åŠ¨ä½œ</h3><p>è¯¥æ–¹æ³•ä½¿ç”¨æŒ‡å®šçš„æ–¹æ³•å‡å°‘RDDä¸­çš„å…ƒç´ ã€‚å¯ä»¥ç”¨è¯¥æ–¹æ³•è®¡ç®—RDDæ€»çš„å…ƒç´ ä¹‹å’Œï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdd1.map(<span class="keyword">lambda</span> x: x[<span class="number">1</span>]).reduce(<span class="keyword">lambda</span> x, y: x + y)</span><br></pre></td></tr></table></figure></p>
<p>åœ¨æ¯ä¸€ä¸ªåˆ†åŒºé‡Œï¼Œreduce()æ–¹æ³•è¿è¡Œæ±‚å’Œæ–¹æ³•ï¼Œå°†æ”¹æ€»å’Œè¿”å›ç»™æœ€ç»ˆèšåˆæ‰€åœ¨çš„ç¨‹åºèŠ‚ç‚¹ã€‚</p>
<p>âš ï¸<strong>è­¦å‘Šï¼š</strong><br>è¦è°¨æ…æ³¨æ„çš„æ˜¯ï¼Œreduceä¼ é€’çš„å‡½æ•°éœ€è¦æ—¶å…³è”çš„ï¼Œæ—¢æ»¡è¶³å…ƒç´ é¡ºåºæ”¹å˜ç»“æœä¸å˜ï¼Œæ“ä½œç¬¦é¡ºåºæ”¹å˜ç»“æœä¸å˜ã€‚å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rdd = sc.parallelize([1, 2, 0.5, 0.1],1)</span><br><span class="line">rdd.reduce(lambda x, y: x / y)</span><br><span class="line"></span><br><span class="line">out: 10.0</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rdd = sc.parallelize([1, 2, 0.5, 0.1],2)</span><br><span class="line">rdd.reduce(lambda x, y: x / y)</span><br><span class="line"></span><br><span class="line">out: 0.1</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬å¸Œæœ›è¾“å‡ºç»“æœæ˜¯10.0ï¼Œç¬¬ä¸€ä¸ªåªæŠŠRDDæ”¾åœ¨ä¸€ä¸ªåˆ†åŒºï¼Œè¾“å‡ºç»“æœç¬¦åˆé¢„æœŸã€‚ä½†æ˜¯åœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œåˆ†äº†2ä¸ªåŒºï¼Œç»“æœå°±ä¸å¯¹äº†ã€‚å› ä¸ºè¯¥æ–¹æ³•æ˜¯åœ¨æ¯ä¸ªåˆ†åŒºå¹¶è¡Œè®¡ç®—çš„ã€‚</p>
<h3 id="reduceByKey-åŠ¨ä½œ"><a href="#reduceByKey-åŠ¨ä½œ" class="headerlink" title=".reduceByKey()  åŠ¨ä½œ"></a>.reduceByKey()  åŠ¨ä½œ</h3><p>è¯¥æ–¹æ³•å’Œ.reduce()æ–¹æ³•ç±»ä¼¼ï¼Œä½†æ˜¯å®åœ¨key-keyåŸºç¡€ä¸Šè¿è¡Œï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data_key = sc.parallelize([(<span class="string">'a'</span>,<span class="number">3</span>), (<span class="string">'a'</span>,<span class="number">1</span>), (<span class="string">'b'</span>,<span class="number">6</span>), (<span class="string">'d'</span>,<span class="number">1</span>), (<span class="string">'b'</span>,<span class="number">6</span>), (<span class="string">'d'</span>,<span class="number">15</span>), (<span class="string">'d'</span>,<span class="number">3</span>), (<span class="string">'a'</span>,<span class="number">7</span>), (<span class="string">'b'</span>, <span class="number">8</span>)],<span class="number">4</span>)</span><br><span class="line">data_key.reduceByKey(<span class="keyword">lambda</span> x, y: x+y).collect()</span><br></pre></td></tr></table></figure>
<pre><code>[(&apos;b&apos;, 20), (&apos;a&apos;, 11), (&apos;d&apos;, 19)]
</code></pre><h3 id="count-åŠ¨ä½œ"><a href="#count-åŠ¨ä½œ" class="headerlink" title=".count()  åŠ¨ä½œ"></a>.count()  åŠ¨ä½œ</h3><p>.count() æ–¹æ³•ç»Ÿè®¡å‡ºäº†RDDé‡Œæ‰€æœ‰çš„å…ƒç´ æ•°é‡ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdd.count()</span><br></pre></td></tr></table></figure></p>
<p>.count() æ–¹æ³•äº§ç”Ÿå…¥æˆæ–¹æ³•åŒæ ·çš„ç»“æœï¼Œä½†ä¸éœ€è¦æŠŠæ•´ä¸ªæ•°æ®é›†ç§»åŠ¨åˆ°é©±åŠ¨ç¨‹åºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">len(rdd.collect()). # âš ï¸è­¦å‘Šï¼šä¸è¦è¿™æ ·åšï¼ï¼</span><br></pre></td></tr></table></figure></p>
<h3 id="countByKey-åŠ¨ä½œ"><a href="#countByKey-åŠ¨ä½œ" class="headerlink" title=".countByKey() åŠ¨ä½œ"></a>.countByKey() åŠ¨ä½œ</h3><p>å¦‚æœæ•°æ®é›†æ˜¯Ket-Valueå½¢å¼ï¼Œå¯ä»¥ä½¿ç”¨.countByKey()æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_key.countByKey().items()</span><br></pre></td></tr></table></figure>
<pre><code>dict_items([(&apos;a&apos;, 3), (&apos;b&apos;, 3), (&apos;d&apos;, 3)])
</code></pre><h3 id="saveAsTextFile-åŠ¨ä½œ"><a href="#saveAsTextFile-åŠ¨ä½œ" class="headerlink" title=".saveAsTextFile()  åŠ¨ä½œ"></a>.saveAsTextFile()  åŠ¨ä½œ</h3><p>è¯¥æ–¹æ³•å°†RDDä¿å­˜ä¸ºæ–‡æœ¬æ–‡ä»¶ï¼šæ¯ä¸ªæ–‡ä»¶ä¸€ä¸ªåˆ†åŒº</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_key.saveAsTextFile(<span class="string">'hdfs://master:9000/out/data_key.txt'</span>)</span><br></pre></td></tr></table></figure>
<p>è¦è¯»å–å®ƒçš„æ—¶å€™éœ€è¦è§£æï¼Œå› ä¸ºæ‰€æœ‰è¡Œéƒ½è¢«è§†ä¸ºå­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parseInput</span><span class="params">(row)</span>:</span></span><br><span class="line">    <span class="keyword">import</span> re</span><br><span class="line">    pattern = re.compile(<span class="string">r"\(\'([a-z]+)\',.([0-9]+)\)"</span>) <span class="comment"># è¿™é‡Œâ€œ+â€å·ä»£è¡¨åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªåŒ¹é…å­—ç¬¦ï¼Œå¦åˆ™é’ˆå¯¹åŒä½æ•°åŠ¨ä½œæ“ä½œä¼šæŠ¥é”™</span></span><br><span class="line">    row_split = pattern.split(row)</span><br><span class="line">    <span class="keyword">return</span> (row_split[<span class="number">1</span>], row_split[<span class="number">2</span>])</span><br><span class="line">data_key_read = sc.textFile(<span class="string">'hdfs://master:9000/out/data_key.txt'</span>)</span><br><span class="line">data_key_read.map(parseInput).collect()</span><br></pre></td></tr></table></figure>
<pre><code>[(&apos;a&apos;, &apos;3&apos;),
 (&apos;a&apos;, &apos;1&apos;),
 (&apos;b&apos;, &apos;6&apos;),
 (&apos;d&apos;, &apos;1&apos;),
 (&apos;b&apos;, &apos;6&apos;),
 (&apos;d&apos;, &apos;15&apos;),
 (&apos;d&apos;, &apos;3&apos;),
 (&apos;a&apos;, &apos;7&apos;),
 (&apos;b&apos;, &apos;8&apos;)]
</code></pre><p>ğŸ’¡åŒæ—¶è¿˜æœ‰ï¼š</p>
<ul>
<li>rdd.saveAsHadoopDataset</li>
<li>rdd.saveAsSequenceFile</li>
<li>â€¦<br>ç­‰æ–¹æ³•</li>
</ul>
<h3 id="foreach-åŠ¨ä½œ"><a href="#foreach-åŠ¨ä½œ" class="headerlink" title=".foreach()  åŠ¨ä½œ"></a>.foreach()  åŠ¨ä½œ</h3><p>è¿™ä¸ªæ–¹æ³•å¯¹RDDé‡Œçš„æ¯ä¸ªå…ƒç´ ï¼Œç”¨è¿­ä»£æ–¹æ³•åº”ç”¨ç›¸åŒçš„å‡½æ•°ï¼›å’Œ<code>.map()</code>ç›¸æ¯”ï¼Œ<code>.foreach()</code>æ–¹æ³•æŒ‰ç…§ä¸€ä¸ªæ¥ä¸€ä¸ªçš„æ–¹å¼ï¼Œå¯¹æ¯ä¸€æ¡è®°å½•åº”ç”¨ä¸€ä¸ªå®šä¹‰å¥½çš„å‡½æ•°ã€‚å½“å¸Œæœ›å°†æ•°æ®æ›¹æ‘é“PySparkæœ¬èº«ä¸æ”¯æŒçš„æ•°æ®åº“æ˜¯ï¼Œè¯¥æ–¹æ³•å¾ˆæœ‰ç”¨ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></span><br><span class="line">    print(x)</span><br><span class="line"></span><br><span class="line">rdd.foreach(f)</span><br></pre></td></tr></table></figure></p>
<h2 id="å°ç»“ï¼š"><a href="#å°ç»“ï¼š" class="headerlink" title="å°ç»“ï¼š"></a>å°ç»“ï¼š</h2><ul>
<li><code>RDDæ˜¯Sparkçš„æ ¸å¿ƒ</code>ï¼›è¿™äº›æ— <code>schema</code>æ•°æ®ç»“æ„æ—©Sparkä¸­å¤„ç†çš„æœ€åŸºæœ¬çš„æ•°æ®ç»“æ„ã€‚</li>
<li>RDDçš„ä¸¤ç§åˆ›å»ºæ–¹å¼ï¼š parallelize å’Œ æ–‡ä»¶è¯»å–</li>
<li>Sparkä¸­çš„è½¬åŒ–æ˜¯æƒ°æ€§çš„ï¼Œåªåœ¨æ“ä½œè¢«è°ƒç”¨æ—¶åº”ç”¨ã€‚</li>
<li>Scala å’Œ Python RDDä¹‹é—´ä¸€ä¸ªä¸»è¦çš„åŒºåˆ«æ˜¯é€Ÿåº¦ï¼š Python RDD æ¯” Scala æ…¢å¾ˆå¤šï¼</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/pyspark/" rel="tag"><i class="fa fa-tag"></i> pyspark</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/Spark Scheduler.html" rel="next" title="Sparkè¿è¡ŒåŸç†å‰–æ">
                <i class="fa fa-chevron-left"></i> Sparkè¿è¡ŒåŸç†å‰–æ
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/Databrickes.html" rel="prev" title="å…å®‰è£…å…é…ç½® è¿˜å…è´¹çš„Spark é›†ç¾¤ --Databrickes Spark Clould">
                å…å®‰è£…å…é…ç½® è¿˜å…è´¹çš„Spark é›†ç¾¤ --Databrickes Spark Clould <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        
<script>
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zNTIxOC8xMTc1NA=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Inhaltsverzeichnis
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Ãœbersicht
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">åˆ˜çŸ¥è¡Œ</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">47</span>
                  <span class="site-state-item-name">Artikel</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">Kategorien</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">Tags</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/hooog" target="_blank" title="Github">
                      
                        <i class="fa fa-fw fa-globe"></i>Github</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/hooog" target="_blank" title="Weibo">
                      
                        <i class="fa fa-fw fa-globe"></i>Weibo</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/hooog" target="_blank" title="ç®€ä¹¦">
                      
                        <i class="fa fa-fw fa-globe"></i>ç®€ä¹¦</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#RDDçš„å†…éƒ¨è¿è¡Œæ–¹å¼"><span class="nav-number">1.</span> <span class="nav-text">RDDçš„å†…éƒ¨è¿è¡Œæ–¹å¼</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åˆ›å»ºRDD"><span class="nav-number">2.</span> <span class="nav-text">åˆ›å»ºRDD</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å…¨å±€ä½œç”¨åŸŸå’Œå±€éƒ¨ä½œç”¨åŸŸ"><span class="nav-number">3.</span> <span class="nav-text">å…¨å±€ä½œç”¨åŸŸå’Œå±€éƒ¨ä½œç”¨åŸŸ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è½¬æ¢"><span class="nav-number">4.</span> <span class="nav-text">è½¬æ¢</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#map-è½¬æ¢"><span class="nav-number">4.1.</span> <span class="nav-text">.map()è½¬æ¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#filter-è½¬æ¢"><span class="nav-number">4.2.</span> <span class="nav-text">.filter()è½¬æ¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flatMap-è½¬æ¢"><span class="nav-number">4.3.</span> <span class="nav-text">.flatMap()è½¬æ¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#distinct-è½¬æ¢"><span class="nav-number">4.4.</span> <span class="nav-text">.distinct()è½¬æ¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sample-è½¬æ¢"><span class="nav-number">4.5.</span> <span class="nav-text">.sample() è½¬æ¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#leftOuterJoin-è½¬æ¢"><span class="nav-number">4.6.</span> <span class="nav-text">.leftOuterJoin()è½¬æ¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#repartition-è½¬æ¢"><span class="nav-number">4.7.</span> <span class="nav-text">.repartition()è½¬æ¢</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åŠ¨ä½œ"><span class="nav-number">5.</span> <span class="nav-text">åŠ¨ä½œ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#collect-åŠ¨ä½œ"><span class="nav-number">5.1.</span> <span class="nav-text">.collect() åŠ¨ä½œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#take-åŠ¨ä½œ"><span class="nav-number">5.2.</span> <span class="nav-text">.take() åŠ¨ä½œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reduce-åŠ¨ä½œ"><span class="nav-number">5.3.</span> <span class="nav-text">.reduce() åŠ¨ä½œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reduceByKey-åŠ¨ä½œ"><span class="nav-number">5.4.</span> <span class="nav-text">.reduceByKey()  åŠ¨ä½œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#count-åŠ¨ä½œ"><span class="nav-number">5.5.</span> <span class="nav-text">.count()  åŠ¨ä½œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#countByKey-åŠ¨ä½œ"><span class="nav-number">5.6.</span> <span class="nav-text">.countByKey() åŠ¨ä½œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#saveAsTextFile-åŠ¨ä½œ"><span class="nav-number">5.7.</span> <span class="nav-text">.saveAsTextFile()  åŠ¨ä½œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#foreach-åŠ¨ä½œ"><span class="nav-number">5.8.</span> <span class="nav-text">.foreach()  åŠ¨ä½œ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å°ç»“ï¼š"><span class="nav-number">6.</span> <span class="nav-text">å°ç»“ï¼š</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">åˆ˜çŸ¥è¡Œ</span>

  
</div>


  <div class="powered-by">
  <span>Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a></span>
  </div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> æœ¬ç«™è®¿å®¢æ•°
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      äººæ¬¡
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> æ€»è®¿é—®é‡
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      æ¬¡
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
